/**
 * The contents of this file are subject to the Mozilla Public License
 * Version 1.1 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 * https://www.mozilla.org/MPL/
 * 
 * Software distributed under the License is distributed on an "AS IS"
 * basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
 * License for the specific language governing rights and limitations
 * under the License.
 * 
 * The Original Code is a JavaScript implementation of Time Style Sheets (TSS).
 * 
 * The Initial Developer of the Original Code is IBM Research (Brazil).
 * Portions created by the Initial Developer are Copyright (C) 2015 
 * the Initial Developer. All Rights Reserved.
 * 
 * Contributor(s): Rodrigo Laiola Guimar√£es <http://www.rodrigolaiola.com>
 */

var time_style=document.createElement("style");time_style.setAttribute("id","tss-styles");time_style.type="text/css";time_style.innerHTML="body{} time {display: none;}";document.head.appendChild(time_style);window.tss={};document.onreadystatechange=function(){document.body.style.visibility="hidden";if(document.readyState==="complete"){try{window.performance.mark("tss_parser")}catch(d){console.time("tss_parser")}var c=document.getElementsByTagName("*");for(var a=0,f=c.length;a<f;a++){if(c[a].hasAttribute("autoplay")&&(c[a].nodeName!="VIDEO"||c[a].nodeName!="AUDIO")){c[a].pause()}}window.tss=new function(){var k=this;var s={};var e={};var n=true;var i=true;function m(v,u,x){for(var w in u){if(!v[w]||x){v[w]=u[w]}}return v}function g(u){return u.replace(/-([a-z])/ig,function(v,w){return w.toUpperCase()})}function l(u){if(u=="timing-container"||u=="timing-delay"||u=="timing-duration"||u=="timing-iteration-count"||u=="timing-play-state"||u=="timing-clip-begin"||u=="timing-clip-end"||u=="timing-volume"||u=="timing-sync-master"||u=="timing-current-time"){return true}else{return false}}function q(v,u){switch(v){case"timing-container":if(u=="par"||u=="seq"){return u}else{return"par"}break;case"timing-delay":if(typeof parseFloat(u)=="number"&&parseFloat(u)>=0){return parseFloat(u)}else{return 0}break;case"timing-duration":if(typeof parseFloat(u)=="number"&&parseFloat(u)>=0){return parseFloat(u)}else{if(u=="infinite"){return u}else{if(u=="implicit"){return undefined}else{return 0}}}break;case"timing-iteration-count":if(typeof parseInt(u)=="number"&&parseInt(u)>=0){return parseInt(u)}else{if(u=="infinite"){return u}else{return 1}}break;case"timing-play-state":if(u=="paused"||u=="running"){return u}else{return"running"}break;case"timing-clip-begin":if(typeof parseFloat(u)=="number"&&parseFloat(u)>=0){return parseFloat(u)}else{return 0}break;case"timing-clip-end":if(typeof parseFloat(u)=="number"&&parseFloat(u)>=0){return parseFloat(u)}else{return undefined}break;case"timing-volume":if(typeof parseFloat(u)=="number"&&parseFloat(u)>=0&&parseFloat(u)<=1){return parseFloat(u)}else{return 1}break;case"timing-sync-master":return u;break;case"timing-current-time":return u;break;default:break}return null}function h(A,L){var z=/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)|(\<\!\-\-([\s\S]*?)\-\-\>)/gm;A=A.replace(z,"");var u=new CSSParser();var w=u.parse(A,false,true);if(w){if(L){var y={};for(var G=0;G<w.cssRules[0].declarations.length;G++){if(l(w.cssRules[0].declarations[G].property)){var x=g(w.cssRules[0].declarations[G].property);y[x]=q(w.cssRules[0].declarations[G].property,w.cssRules[0].declarations[G].valueText)}}var D=L.getAttribute("tss-hash");if(!D){D=Math.floor(Math.random()*90000)+10000;L.setAttribute("tss-hash",D)}e[D]=m(y,e[D]);return e[D]}else{for(var I=0;I<w.cssRules.length;I++){if(!w.cssRules[I].mSelectorText||w.cssRules[I].mSelectorText.trim()==""){continue}var v=w.cssRules[I].mSelectorText.split(",");for(var G=0;G<v.length;G++){if(v[G].trim().indexOf(":")!=-1){var B=v[G].substring(0,v[G].indexOf(":"));var C=v[G].substring(v[G].indexOf(":")+1,v[G].length);var y={};for(var F=0;F<w.cssRules[I].declarations.length;F++){var x=w.cssRules[I].declarations[F].property;y[x]=w.cssRules[I].declarations[F].valueText}var J=document.getElementById("tss-styles");var H=J.sheet?J.sheet:J.styleSheet;function E(O){var N="";if(!O||O.length==0){return N}for(var M in O){N=N+M+": "+O[M]+"; "}return N}try{H.insertRule(B+"[tss-state="+C+"] {"+E(y)+"}",1)}catch(K){}}else{var y={};for(var F=0;F<w.cssRules[I].declarations.length;F++){if(l(w.cssRules[I].declarations[F].property)){var x=g(w.cssRules[I].declarations[F].property);y[x]=q(w.cssRules[I].declarations[F].property,w.cssRules[I].declarations[F].valueText)}}s[v[G].trim()]?s[v[G].trim()]=m(y,s[v[G].trim()]):s[v[G].trim()]=y}}}return}}else{console.log("error parsing time style sheets")}}function j(u){if(s[u]&&s[u].specificity){return s[u].specificity}function y(A){A=A.replace(/\#+/g," #");A=A.replace(/\.+/g," .");A=A.replace(/\:+/g," :");A=A.replace(/\[+/g," [");A=A.replace(/\*+/g," ");return A.split(/\ +|\++|\~+|\>+/).filter(function(B){return B})}var x=y(u);var v=b=z=0;for(var w=0;w<x.length;w++){v=v+(x[w].match(/\#/)?x[w].match(/\#/).length:0);b=b+(x[w].match(/\./)?x[w].match(/\./).length:0)+(x[w].match(/:[:]+/)?x[w].match(/:[:]+/).length:0)+(x[w].match(/\[.+\]$/)?x[w].match(/\[.+\]$/).length:0)}var z=x.length-(v+b);return parseInt(""+v+b+z)}function r(v){if(!v){return{}}var u=[];for(var w in v){u.push({key:w,specificity:j(w)})}return u.sort(function(y,x){return x.specificity-y.specificity})}function p(A,E){var D=r(s);if(E){e=[]}for(var x=0;x<D.length;x++){s[D[x].key].specificity=D[x].specificity;var u=document.querySelectorAll(D[x].key);for(var w=0;w<u.length;w++){var v=u[w];var y=s[D[x].key];if(!v||(A&&v!=A)){continue}var B=v.getAttribute("tss-hash");if(!B){B=Math.floor(Math.random()*90000)+10000;v.setAttribute("tss-hash",B)}if(e[B]!=null){y=m(e[B],y)}else{if(v.getAttribute("style")!=null){y=m(h("{"+v.getAttribute("style")+"}",v),y)}}v.setAttribute("tss-parsed",true);e[B]=y}}if(!A){var y=document.body.getElementsByTagName("*");for(var x=0;x<y.length;x++){var v=y[x];if(!v.getAttribute("tss-parsed")){var B=v.getAttribute("tss-hash");if(!B){B=Math.floor(Math.random()*90000)+10000;v.setAttribute("tss-hash",B)}if(v.getAttribute("style")!=null){e[B]=h("{"+v.getAttribute("style")+"}",v)}if(v.hasAttribute("autoplay")){e[B]=m({timingPlayState:"running"},e[B]);v.removeAttribute("autoplay")}}}if(!E){document.body.style.visibility=""}try{window.performance.measure("tss_parser");console.log("calculating tss_parser.js execution time: "+(window.performance.getEntriesByType("measure")[0].duration-window.performance.getEntriesByType("mark")[0].startTime).toPrecision(5)+"ms")}catch(z){console.timeEnd("calculating tss_parser.js execution time")}var C;try{C=new CustomEvent("ontssparserready",{detail:E})}catch(z){C=document.createEvent("Event");C.initEvent("ontssparserready",true,true);C.detail=E}document.dispatchEvent(C)}}function t(){function v(){if(i){var B=document.getElementsByTagName("style");for(var A=0;A<B.length;A++){h(B[A].innerHTML,null)}}if(n){var B=document.getElementsByTagName("time");for(var A=0;A<B.length;A++){h(B[A].innerHTML,null)}}p()}var z=0;var u=document.getElementsByTagName("link");for(var x=0;x<u.length;x++){var y=u[x];if((n&&(y.rel=="timesheet"||y.type=="text/tss"))||(i&&(y.rel=="stylesheet"||y.type=="text/css"))){z=z+1}}if(z==0){v()}else{for(var x=0;x<u.length;x++){var y=u[x];if(n&&(y.rel=="timesheet"||y.type=="text/tss")||i&&(y.rel=="stylesheet"||y.type=="text/css")){function w(A){var B=new XMLHttpRequest();B.open("get",A.href);B.onreadystatechange=function(){if(B.readyState===4){if(B.status===200){h(B.responseText,null)}else{console.log("error importing time style sheets: "+B.status)}z=z-1;if(z==0){v()}}};B.send(null)}w(y)}}}}function o(){var y=document.querySelector("body");function u(B){if(B.nodeType===1&&B.nodeName!="SCRIPT"&&B.nodeName!="LINK"&&B.nodeName!="STYLE"&&B.nodeName!="SOURCE"&&B.nodeName!="TIME"){var A=B.querySelectorAll("style");for(var z=0;z<A.length;z++){h(A[z].innerHTML,null)}if(A.length>0){p(B,A.length>0)}else{p(B)}}else{if(B.nodeName=="LINK"){}else{if((B.nodeName=="STYLE"&&i)||(B.nodeName=="TIME"&&n)){h(B.innerHTML,null);p(null,true)}}}}try{var v=new MutationObserver(function(z){z.forEach(function(A){switch(A.type){case"childList":for(var B=0;B<A.addedNodes.length;B++){var C=A.addedNodes[B];u(C)}break;case"attributes":if(A.attributeName=="style"){}break;default:break}})});var w={attributes:true,childList:true,characterData:true,subtree:true};v.observe(y,w)}catch(x){y.addEventListener("DOMNodeInserted",function(z){if(z.target!=null){u(z.target)}},false)}}k.lookup=function(v){if(typeof v=="string"){var u=s[v];if(u){if(!u.specificity){u.specificity=j(v)}return u}else{return{specificity:j(v)}}}else{if(!v.getAttribute("tss-hash")){p(v)}return e[v.getAttribute("tss-hash")]}};window.tss=k.lookup;t();o();return k.lookup}}};function extend(d,c,h){for(var f in c){var g=Object.getOwnPropertyDescriptor(d,f);var e=Object.getOwnPropertyDescriptor(c,f);if(!g||h){if(e&&e.get){Object.defineProperty(d,f,{get:e.get,set:e.set,enumerable:e.enumerable,configurable:e.configurable})}else{Object.defineProperty(d,f,{value:e.value,enumerable:e.enumerable,writable:e.writable,configurable:e.configurable})}}}return d}HTMLElement.prototype.hasClass=function(a){return new RegExp("(?:^|\\s+)"+a+"(?:\\s+|$)").test(this.className)};HTMLElement.prototype.addClass=function(c){if(!c){return}c=c.split(" ");for(var a=0;a<c.length;a++){if(!this.hasClass(c[a])){this.className=this.className?[this.className,c[a]].join(" "):c[a]}}};HTMLElement.prototype.removeClass=function(d){if(!d){return}d=d.split(" ");for(var a=0;a<d.length;a++){if(this.hasClass(d[a])){var e=this.className;this.className=e.replace(new RegExp("(?:^|\\s+)"+d[a]+"(?:\\s+|$)","g"),"")}}};HTMLElement.prototype.bind=function(e,f,a){if(!e){return}e=e.split(" ");for(var d=0;d<e.length;d++){if(!this["ontss"+e[d]]){this["ontss"+e[d]]=new Array()}if(a){this["ontss"+e[d]].unshift(f)}else{this["ontss"+e[d]].push(f)}if(this.addEventListener){if(a){for(var c=0;c<this["ontss"+e[d]].length;c++){this.removeEventListener(e[d],this["ontss"+e[d]][c])}for(var c=0;c<this["ontss"+e[d]].length;c++){this.addEventListener(e[d],this["ontss"+e[d]][c])}}else{this.addEventListener(e[d],f,false)}}else{if(this.attachEvent){if(a){for(var c=0;c<this["ontss"+e[d]].length;c++){this.detachEvent("on"+e[d],this["ontss"+e[d]][c])}for(var c=0;c<this["ontss"+e[d]].length;c++){this.attachEvent("on"+e[d],this["ontss"+e[d]][c])}}else{this.attachEvent("on"+e[d],f)}}else{}}}};HTMLElement.prototype.unbind=function(d,e){if(!d){return}d=d.split(" ");for(var c=0;c<d.length;c++){if(this.removeEventListener){for(var a=0;this["ontss"+d[c]]&&a<this["ontss"+d[c]].length;a++){if(!e){this.removeEventListener(d[c],this["ontss"+d[c]][a])}else{if(e==this["ontss"+d[c]][a]){this.removeEventListener(d[c],this["ontss"+d[c]][a]);this["ontss"+d[c]].splice(a,1);a--}}}}else{if(this.detachEvent){for(var a=0;a<this["ontss"+d[c]].length;a++){if(!e){this.detachEvent("on"+d[c],this["ontss"+d[c]][a])}else{if(e==this["ontss"+d[c]][a]){this.detachEvent("on"+d[c],this["ontss"+d[c]][a]);this["ontss"+d[c]].splice(a,1);a--}}}}else{}}if(!e){this["ontss"+d[c]]=null}}};HTMLElement.prototype.trigger=function(f,a){var d;try{d=new CustomEvent(f,{detail:a})}catch(g){d=document.createEvent("Event");d.initEvent(f,true,true);d.detail=a}if(document.createEvent){this.dispatchEvent(d)}else{if(this.fireEvent){element.fireEvent("on"+d.eventType,f)}else{if(this["on"+f]||false){for(var c=0;c<this["ontss"+d.type].length;c++){if(typeof this["ontss"+d.type][c]=="function"){this["ontss"+d.type][c](f,a)}}}}}};(function(){window.performance=window.performance||{};performance.now=(function(){return performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||Date.now})();var a=function(){this.timeout=40;this.itemList=[];this.lastTimeout=null;var d=this;var c=function(){d.lastTimeout=performance.now();d.timeupdate()};c()};a.prototype={add:function(d){for(var c=0;c<this.itemList.length;c++){if(this.itemList[c]==d){return false}}this.itemList.push(d);if(this.itemList.length==1){this.lastTimeout=null;this.timeupdate()}return true},remove:function(d){for(var c=0;c<this.itemList.length;c++){if(this.itemList[c]==d){this.itemList.splice(c,1);return true}}return false},timeupdate:function(){if(this.itemList.length==0){return}var d=performance.now();var c=d-this.lastTimeout;this.lastTimeout=d;for(var e=0;e<this.itemList.length;e++){var f=this.itemList[e];f.trigger("tempoupdate",c)}setTimeout("window.tempo.timeupdate()",this.timeout)}};window.tempo=new a()})();var TSS_PLAY_EVENT="onplay";var TSS_PAUSE_EVENT="onpause";var TSS_BEGIN_EVENT="onbegin";var TSS_END_EVENT="onend";var TSS_YIELD_EVENT="onyield";var TSS_WAIT_EVENT="onwait";var TSS_CAN_PLAY_EVENT="oncanplay";var TSS_TIMEUPDATE_EVENT="ontimeupdate";window.TSSPar;window.TSSSeq;window.TSSMedia;(function(){var parseItem=function(elem,parent){if(!elem){return}var item;var options=extend({},window.tss(elem)?window.tss(elem):{});options.domNode=elem;options.parent=parent;if(!options.timingContainer){if(elem.nodeType===1&&(elem.nodeName=="VIDEO"||elem.nodeName=="AUDIO"||elem.nodeName=="IMG")){}else{options.timingContainer="par"}}switch(options.timingContainer){case"seq":item=new TSSSeq(options);break;case"par":item=new TSSPar(options);break;default:item=new TSSMedia(options);break}return item};function findSyncMaster(sync){return document.querySelector(sync)}TSSPar=function(options){var settings=extend(options,{timingDelay:null,timingDuration:null,timingIterationCount:1,timingPlayState:null,timingSyncMaster:null,domNode:null,parent:null});var self=settings.domNode;if(Object.getOwnPropertyDescriptor(self.style,"timingDelay")&&self.style.timingContainer){if(self.style.timingContainer!="par"){self.style.timingContainer=settings.timingContainer}if(self.style.timingDelay!=settings.timingDelay){self.style.timingDelay=settings.timingDelay}if(self.style.timingDuration!=settings.timingDuration){self.style.timingDuration=settings.timingDuration}if(self.style.timingIterationCount!=settings.timingIterationCount){self.style.timingIterationCount=settings.timingIterationCount}if(self.style.timingPlayState!=settings.timingPlayState){self.style.timingPlayState=settings.timingPlayState}if(self.style.timingSyncMaster!=settings.timingSyncMaster){self.style.timingSyncMaster=settings.timingSyncMaster}return null}var voided=false;var initiated=false;var begun=false;var paused=true;var ended=false;var error=false;var waiting=false;var canplay=true;var dur=settings.timingDuration?parseFloat(settings.timingDuration):settings.timingDuration;var repeatCount=settings.timingIterationCount=="infinite"?9007199254740992:parseInt(settings.timingIterationCount);var repeatInstance=repeatCount;var muted=false;var playbackRate=1;var currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;var delayComputed=true;var itemList=[];var observer;self.setAttribute("tss-state","not-active");function timeUpdateListener(event){event.stopPropagation();if(event.type==TSS_TIMEUPDATE_EVENT){var newTime=event.detail;var delay=settings.timingDelay!=null?(1*parseFloat(settings.timingDelay)):0;currentTime=newTime-delay;if(begun&&currentTime<0){self.setAttribute("tss-state","not-active");delayComputed=false}if(ended&&newTime<=delay+dur){that.currentTime=newTime-delay}}else{if(begun&&!paused){currentTime=currentTime+event.detail/1000}}if(!delayComputed&&currentTime>=0){delayComputed=true;begun=false;that.play}if(begun&&!ended&&typeof dur=="number"&&currentTime>=dur){currentTime=0;ended=true;for(var i=0;i<itemList.length;i++){itemList[i].style.stop}self.trigger(TSS_END_EVENT)}if(paused){return}self.trigger(TSS_TIMEUPDATE_EVENT,currentTime);var evtAttr=self.getAttribute(TSS_TIMEUPDATE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}}var f;self.bind(TSS_PLAY_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_PLAY_EVENT,f);return}paused=false;var evtAttr=self.getAttribute(TSS_PLAY_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}if(!begun){begun=true;ended=false;self.trigger(TSS_BEGIN_EVENT)}},false);self.bind(TSS_PAUSE_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_PAUSE_EVENT,f);return}paused=true;var evtAttr=self.getAttribute(TSS_PAUSE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},false);self.bind(TSS_BEGIN_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_BEGIN_EVENT,f);return}if(delayComputed){self.setAttribute("tss-state","active")}var evtAttr=self.getAttribute(TSS_BEGIN_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},false);self.bind(TSS_END_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_END_EVENT,f);return}paused=true;begun=false;ended=true;waiting=false;canplay=true;var evtAttr=self.getAttribute(TSS_END_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;self.setAttribute("tss-state","not-active");repeatInstance--;if(repeatInstance<=0){settings.timingPlayState="paused";repeatInstance=repeatCount;self.trigger(TSS_YIELD_EVENT);if(!settings.timingSyncMaster){window.tempo.remove(self)}initiated=false;delayComputed=true;self.unbind("tempoupdate")}else{that.play}},false);var setupItem=function(elem){if(!elem){return}elem.bind(TSS_BEGIN_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_BEGIN_EVENT,this);return}});elem.bind(TSS_PLAY_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_PLAY_EVENT,this);return}if(!paused&&begun){return}return});elem.bind(TSS_PAUSE_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_PAUSE_EVENT,this);return}if(paused){return}return});elem.bind(TSS_YIELD_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_YIELD_EVENT,this);return}if(ended){return}for(var i=0;i<itemList.length;i++){if(itemList[i].style.begun&&!itemList[i].style.ended){return}}if(typeof dur!="number"){self.trigger(TSS_END_EVENT)}});elem.bind(TSS_WAIT_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_WAIT_EVENT,this);return}waiting=true;canplay=false;self.trigger(TSS_WAIT_EVENT)});elem.bind(TSS_CAN_PLAY_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_CAN_PLAY_EVENT,this);return}for(var i=0;i<itemList.length;i++){if(itemList[i].style.waiting){return}}waiting=false;canplay=true;self.trigger(TSS_CAN_PLAY_EVENT)})};var validateChildren=function(){itemList=[];if(self.hasChildNodes()){var child=self.firstChild;while(child){if(child.nodeType===1&&child.nodeName!="SCRIPT"&&child.nodeName!="LINK"&&child.nodeName!="STYLE"&&child.nodeName!="SOURCE"&&child.nodeName!="TIME"){if(Object.getOwnPropertyDescriptor(child.style,"timingDelay")){}else{var item=parseItem(child,self);extend(child.style,item)}itemList.push(child)}child=child.nextSibling}}};validateChildren();for(var i=0;i<itemList.length;i++){var child=itemList[i];setupItem(child)}try{observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){var target=mutation.target;switch(mutation.type){case"childList":validateChildren();for(var i=0;i<mutation.addedNodes.length;i++){var child=mutation.addedNodes[i];if(itemList.indexOf(child)>=0){setupItem(child)}}for(var i=0;i<mutation.removedNodes.length;i++){var child=mutation.removedNodes[i]}if(begun&&!paused){that.pause;that.play}break;case"attributes":if(mutation.attributeName=="style"){}break;default:break}})});var config={attributes:true,childList:true,characterData:true};observer.observe(self,config)}catch(e){self.addEventListener("DOMNodeInserted",function(ev){validateChildren();if(itemList.indexOf(ev.target)>=0){setupItem(ev.target)}},false)}var that={};Object.defineProperty(that,"timingContainer",{get:function(){if(voided){return}return"par"},set:function(newValue){if(voided){return}if(newValue=="par"){return}else{if(newValue=="seq"){var playState=settings.timingPlayState;this.stop;voided=true;settings.timingContainer="seq";var newSeq=new TSSSeq(settings);that=newSeq;extend(settings.domNode.style,that,true);that.timingPlayState=playState}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingDelay",{get:function(){return settings.timingDelay!=null?(parseFloat(settings.timingDelay)):0},set:function(newValue){if(newValue==null){return}settings.timingDelay=newValue!=null?parseFloat(newValue):0;if(!begun){currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0}},enumerable:true,configurable:true});Object.defineProperty(that,"timingDuration",{get:function(){if(dur){return dur}if(itemList.length==0){return"infinite"}var maxDur=0;for(var i=0;i<itemList.length;i++){var aux=itemList[i].style.timingDuration;if(aux=="infinite"||maxDur=="infinite"){return"infinite"}maxDur=Math.max(maxDur,aux)}return maxDur},set:function(newValue){if(newValue==null){return}dur=newValue=="infinite"?9007199254740992:parseFloat(newValue)},enumerable:true,configurable:true});Object.defineProperty(that,"timingIterationCount",{get:function(){return repeatCount==9007199254740992?"infinite":repeatCount},set:function(newValue){if(newValue==null){return}repeatCount=newValue=="infinite"?9007199254740992:parseInt(newValue);repeatInstance=repeatCount;if(repeatCount<=0&&!paused){this.stop}},enumerable:true,configurable:true});Object.defineProperty(that,"timingPlayState",{get:function(){return settings.timingPlayState},set:function(newValue){if(newValue=="paused"){settings.timingPlayState=newValue;this.pause}else{if(newValue=="running"){settings.timingPlayState=newValue;this.play}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingSyncMaster",{get:function(){return settings.timingSyncMaster},set:function(newValue){if(newValue==null){return}},enumerable:true,configurable:true});Object.defineProperty(that,"initialize",{get:function(){if(initiated){return}self.setAttribute("tss-state","not-active");var that=this;self.bind("tempoupdate",timeUpdateListener,true);if(settings.timingSyncMaster){try{findSyncMaster(settings.timingSyncMaster).bind(TSS_TIMEUPDATE_EVENT,timeUpdateListener)}catch(e){}}else{window.tempo.add(self)}initiated=true},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"destroy",{get:function(){if(initiated){window.tempo.remove(self);for(var i=0;i<itemList.length;i++){itemList[i].style.destroy}}self.unbind(TSS_PLAY_EVENT+" "+TSS_PAUSE_EVENT+" "+TSS_BEGIN_EVENT+" "+TSS_END_EVENT+" tempoupdate "+TSS_YIELD_EVENT);return delete self},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"play",{get:function(){if(begun&&!paused){return}var restart=ended;this.initialize;if(!ended&&settings.timingPlayState=="paused"){return}else{settings.timingPlayState="running"}if(currentTime<0){delayComputed=false}self.trigger(TSS_PLAY_EVENT);if(delayComputed){var allEnded=true;for(var i=0;i<itemList.length;i++){if(itemList[i].style.begun&&!itemList[i].style.ended){allEnded=false;break}}for(var i=0;i<itemList.length;i++){if(!itemList[i].style.ended||restart||(allEnded&&(typeof dur!="number"||currentTime<dur))){itemList[i].style.play}}}},set:function(force){},enumerable:true,configurable:true});Object.defineProperty(that,"pause",{get:function(){if(paused){return}self.trigger(TSS_PAUSE_EVENT);for(var i=0;i<itemList.length;i++){itemList[i].style.pause}},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"stop",{get:function(){if(!begun){return}if(!ended){repeatInstance=-1;self.trigger(TSS_END_EVENT);for(var i=0;i<itemList.length;i++){itemList[i].style.stop}}},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"begun",{get:function(){return begun},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"ended",{get:function(){return ended},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"playing",{get:function(){return !paused},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"paused",{get:function(){return paused},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"waiting",{get:function(){return waiting},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"canplay",{get:function(){return canplay},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"currentTime",{get:function(){return currentTime},set:function(t){if(!begun||ended){this.play;this.pause}t=parseFloat(t);if(typeof t=="number"&&!isNaN(t)){currentTime=t}},enumerable:true,configurable:true});return that};TSSSeq=function(options){var settings=extend(options,{timingDelay:null,timingDuration:null,timingIterationCount:1,timingPlayState:null,timingSyncMaster:null,domNode:null,parent:null});var self=settings.domNode;if(Object.getOwnPropertyDescriptor(self.style,"timingDelay")&&self.style.timingContainer){if(self.style.timingContainer!="seq"){self.style.timingContainer=settings.timingContainer}if(self.style.timingDelay!=settings.timingDelay){self.style.timingDelay=settings.timingDelay}if(self.style.timingDuration!=settings.timingDuration){self.style.timingDuration=settings.timingDuration}if(self.style.timingIterationCount!=settings.timingIterationCount){self.style.timingIterationCount=settings.timingIterationCount}if(self.style.timingPlayState!=settings.timingPlayState){self.style.timingPlayState=settings.timingPlayState}if(self.style.timingSyncMaster!=settings.timingSyncMaster){self.style.timingSyncMaster=settings.timingSyncMaster}return null}var voided=false;var initiated=false;var begun=false;var paused=true;var ended=false;var error=false;var waiting=false;var canplay=true;var dur=settings.timingDuration?parseFloat(settings.timingDuration):settings.timingDuration;var repeatCount=settings.timingIterationCount=="infinite"?9007199254740992:parseInt(settings.timingIterationCount);var repeatInstance=repeatCount;var muted=false;var playbackRate=1;var currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;var delayComputed=true;var itemList=[];var itemIndex=-1;var currItem=null;var observer;self.setAttribute("tss-state","not-active");function timeUpdateListener(event){event.stopPropagation();if(event.type==TSS_TIMEUPDATE_EVENT){var newTime=event.detail;var delay=settings.timingDelay!=null?(1*parseFloat(settings.timingDelay)):0;currentTime=newTime-delay;if(begun&&currentTime<0){self.setAttribute("tss-state","not-active");delayComputed=false}if(ended&&newTime<=delay+dur){that.currentTime=newTime-delay}}else{if(begun&&!paused){currentTime=currentTime+event.detail/1000}}if(!delayComputed&&currentTime>=0){delayComputed=true;begun=false;that.play}if(begun&&!ended&&typeof dur=="number"&&currentTime>=dur){currentTime=0;ended=true;if(currItem){currItem.style.stop}self.trigger(TSS_END_EVENT)}if(paused){return}self.trigger(TSS_TIMEUPDATE_EVENT,currentTime);var evtAttr=self.getAttribute(TSS_TIMEUPDATE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}}var f;self.bind(TSS_PLAY_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_PLAY_EVENT,f);return}paused=false;var evtAttr=self.getAttribute(TSS_PLAY_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}if(!begun){begun=true;ended=false;self.trigger(TSS_BEGIN_EVENT)}},false);self.bind(TSS_PAUSE_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_PAUSE_EVENT,f);return}paused=true;var evtAttr=self.getAttribute(TSS_PAUSE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},false);self.bind(TSS_BEGIN_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_BEGIN_EVENT,f);return}if(delayComputed){self.setAttribute("tss-state","active")}var evtAttr=self.getAttribute(TSS_BEGIN_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},false);self.bind(TSS_END_EVENT,f=function(event){event.stopPropagation();if(voided){self.unbind(TSS_END_EVENT,f);return}paused=true;begun=false;ended=true;waiting=false;canplay=true;var evtAttr=self.getAttribute(TSS_END_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;self.setAttribute("tss-state","not-active");repeatInstance--;if(repeatInstance<=0){settings.timingPlayState="paused";repeatInstance=repeatCount;self.trigger(TSS_YIELD_EVENT);if(!settings.timingSyncMaster){window.tempo.remove(self)}initiated=false;delayComputed=true;itemIndex=-1;currItem=null;self.unbind("tempoupdate")}else{currItem=null;that.play}},false);var getCurrItemIndex=function(){return itemIndex};var getItemIndex=function(item){for(var i=0;i<itemList.length;i++){if(itemList[i]==item){return i}}return -1};var setupItem=function(elem){var item=elem;if(!elem){return}elem.bind(TSS_BEGIN_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_BEGIN_EVENT,this);return}});elem.bind(TSS_PLAY_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_PLAY_EVENT,this);return}if(!begun){itemIndex=getItemIndex(item);currItem=itemList[itemIndex]}itemIndex=getItemIndex(item);currItem=itemList[itemIndex];for(var i=0;i<itemList.length;i++){if(i!=itemIndex&&itemList[i].style.playing){itemList[i].style.stop}}if(paused){self.trigger(TSS_PLAY_EVENT)}});elem.bind(TSS_PAUSE_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_PAUSE_EVENT,this);return}});elem.bind(TSS_YIELD_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_YIELD_EVENT,this);return}if(ended){return}if(getCurrItemIndex()!=getItemIndex(item)){return}if(getCurrItemIndex()==itemList.length-1){itemIndex=-1;currItem=null;if(typeof dur!="number"){self.trigger(TSS_END_EVENT)}}else{itemIndex=itemIndex+1;currItem=itemList[itemIndex];if(currItem.style.paused){currItem.style.play}}});elem.bind(TSS_WAIT_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_WAIT_EVENT,this);return}waiting=true;canplay=false;self.trigger(TSS_WAIT_EVENT)});elem.bind(TSS_CAN_PLAY_EVENT,function(event){event.stopPropagation();if(voided){self.unbind(TSS_CAN_PLAY_EVENT,this);return}if(getCurrItemIndex()!=getItemIndex(item)){return}waiting=false;canplay=true;self.trigger(TSS_CAN_PLAY_EVENT)})};var validateChildren=function(){itemList=[];if(self.hasChildNodes()){var child=self.firstChild;while(child){if(child.nodeType===1&&child.nodeName!="SCRIPT"&&child.nodeName!="LINK"&&child.nodeName!="STYLE"&&child.nodeName!="SOURCE"&&child.nodeName!="TIME"){if(Object.getOwnPropertyDescriptor(child.style,"timingDelay")){}else{var item=parseItem(child,self);extend(child.style,item)}itemList.push(child)}child=child.nextSibling}}};validateChildren();for(var i=0;i<itemList.length;i++){var child=itemList[i];setupItem(child)}try{observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){var target=mutation.target;switch(mutation.type){case"childList":validateChildren();for(var i=0;i<mutation.addedNodes.length;i++){var child=mutation.addedNodes[i];if(itemList.indexOf(child)>=0){setupItem(child)}}for(var i=0;i<mutation.removedNodes.length;i++){var child=mutation.removedNodes[i]}break;case"attributes":if(mutation.attributeName=="style"){}break;default:break}})});var config={attributes:true,childList:true,characterData:true};observer.observe(self,config)}catch(e){self.addEventListener("DOMNodeInserted",function(ev){validateChildren();if(itemList.indexOf(ev.target)>=0){setupItem(ev.target)}},false)}var that={};Object.defineProperty(that,"timingContainer",{get:function(){if(voided){return}return"seq"},set:function(newValue){if(voided){return}if(newValue=="seq"){return}else{if(newValue=="par"){var playState=settings.timingPlayState;this.stop;voided=true;settings.timingContainer="par";var newPar=new TSSPar(settings);that=newPar;extend(settings.domNode.style,that,true);that.timingPlayState=playState}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingDelay",{get:function(){return settings.timingDelay!=null?(parseFloat(settings.timingDelay)):0},set:function(newValue){if(newValue==null){return}settings.timingDelay=newValue!=null?parseFloat(newValue):0;if(!begun){currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0}},enumerable:true,configurable:true});Object.defineProperty(that,"timingDuration",{get:function(){if(dur){return dur}if(itemList.length==0){return 9007199254740992}var childrenDur=0;for(var i=0;i<itemList.length;i++){var aux=itemList[i].style.timingDuration;if(aux=="infinite"){return aux}childrenDur+=aux}return childrenDur},set:function(newValue){if(newValue==null){return}dur=newValue=="infinite"?9007199254740992:parseFloat(newValue)},enumerable:true,configurable:true});Object.defineProperty(that,"timingIterationCount",{get:function(){return repeatCount==9007199254740992?"infinite":repeatCount},set:function(newValue){if(newValue==null){return}repeatCount=newValue=="infinite"?9007199254740992:parseInt(newValue);repeatInstance=repeatCount;if(repeatCount<=0&&!paused){this.stop}},enumerable:true,configurable:true});Object.defineProperty(that,"timingPlayState",{get:function(){return settings.timingPlayState},set:function(newValue){if(newValue=="paused"){settings.timingPlayState=newValue;this.pause}else{if(newValue=="running"){settings.timingPlayState=newValue;this.play}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingSyncMaster",{get:function(){return settings.timingSyncMaster},set:function(newValue){if(newValue==null){return}},enumerable:true,configurable:true});Object.defineProperty(that,"initialize",{get:function(){if(initiated){return}self.setAttribute("tss-state","not-active");var that=this;self.bind("tempoupdate",timeUpdateListener);if(settings.timingSyncMaster){try{findSyncMaster(settings.timingSyncMaster).bind(TSS_TIMEUPDATE_EVENT,timeUpdateListener)}catch(e){}}else{window.tempo.add(self)}initiated=true},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"destroy",{get:function(){if(initiated){window.tempo.remove(self);for(var i=0;i<itemList.length;i++){itemList[i].style.destroy}}self.unbind(TSS_PLAY_EVENT+" "+TSS_PAUSE_EVENT+" "+TSS_BEGIN_EVENT+" "+TSS_END_EVENT+" tempoupdate "+TSS_YIELD_EVENT);return delete self},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"play",{get:function(){if(begun&&!paused){return}this.initialize;if(!ended&&settings.timingPlayState=="paused"){return}else{settings.timingPlayState="running"}if(currentTime<0){delayComputed=false}self.trigger(TSS_PLAY_EVENT);if(delayComputed){if(itemList.length>0){if(!currItem){itemIndex=0;currItem=itemList[itemIndex]}currItem.style.play}}},set:function(force){},enumerable:true,configurable:true});Object.defineProperty(that,"pause",{get:function(){self.trigger(TSS_PAUSE_EVENT);if(currItem){currItem.style.pause}},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"stop",{get:function(){if(!begun){return}if(!ended){var item=currItem;repeatInstance=-1;self.trigger(TSS_END_EVENT);if(item){item.style.stop}}},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"begun",{get:function(){return begun},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"ended",{get:function(){return ended},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"playing",{get:function(){return !paused},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"paused",{get:function(){return paused},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"waiting",{get:function(){return waiting},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"canplay",{get:function(){return canplay},set:function(){},enumerable:true,configurable:true});Object.defineProperty(that,"currentTime",{get:function(){return currentTime},set:function(t){if(!begun||ended){this.play;this.pause}t=parseFloat(t);if(typeof t=="number"&&!isNaN(t)){currentTime=t}},enumerable:true,configurable:true});return that};TSSMedia=function(options){var settings=extend(options,{timingDelay:null,timingDuration:null,timingIterationCount:1,timingPlayState:null,timingClipBegin:0,timingClipEnd:9007199254740992,timingVolume:null,timingSyncMaster:null,domNode:null,parent:null});var self=settings.domNode;if(Object.getOwnPropertyDescriptor(self.style,"timingDelay")){if(self.style.timingDelay!=settings.timingDelay){self.style.timingDelay=settings.timingDelay}if(self.style.timingDuration!=settings.timingDuration){self.style.timingDuration=settings.timingDuration}if(self.style.timingIterationCount!=settings.timingIterationCount){self.style.timingIterationCount=settings.timingIterationCount}if(self.style.timingPlayState!=settings.timingPlayState){self.style.timingPlayState=settings.timingPlayState}if(self.style.timingSyncMaster!=settings.timingSyncMaster){self.style.timingSyncMaster=settings.timingSyncMaster}return null}var initiated=false;var begun=false;var paused=true;var ended=false;var error=false;var waiting=false;var canplay=true;var media_type=settings.domNode.nodeType===1&&(settings.domNode.nodeName=="VIDEO"||settings.domNode.nodeName=="AUDIO")?0:1;var clipBegin=parseFloat(settings.timingClipBegin);var clipEnd=parseFloat(settings.timingClipEnd);var dur=settings.timingDuration?parseFloat(settings.timingDuration):media_type==1?9007199254740992:typeof clipBegin=="number"&&typeof clipEnd=="number"?clipEnd-clipBegin:9007199254740992;var repeatCount=settings.timingIterationCount=="infinite"?9007199254740992:parseInt(settings.timingIterationCount);var repeatInstance=repeatCount;var muted=false;var volume=settings.timingVolume?parseFloat(settings.timingVolume):null;var playbackRate=1;var currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;var delayComputed=true;self.setAttribute("tss-state","not-active");function timeUpdateListener(event){event.stopPropagation();if(media_type==0){this.currentTime=event.detail}else{if(event.type==TSS_TIMEUPDATE_EVENT){var newTime=event.detail;var delay=settings.timingDelay!=null?(1*parseFloat(settings.timingDelay)):0;currentTime=newTime-delay;if(begun&&currentTime<0){self.setAttribute("tss-state","not-active");delayComputed=false}if(ended&&newTime<=delay+dur){that.currentTime=newTime-delay}}else{if((begun&&!paused)){currentTime=currentTime+event.detail/1000}}if(!delayComputed&&currentTime>=0){delayComputed=true;if(media_type==0){window.tempo.remove(self)}begun=false;that.play}if(begun&&!ended&&currentTime>=dur){currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;self.trigger(TSS_END_EVENT)}if(paused){return}self.trigger(TSS_TIMEUPDATE_EVENT,currentTime);var evtAttr=self.getAttribute(TSS_TIMEUPDATE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}}}self.bind(TSS_PLAY_EVENT,function(event){event.stopPropagation();paused=false;var evtAttr=self.getAttribute(TSS_PLAY_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}if(!begun){begun=true;ended=false;self.trigger(TSS_BEGIN_EVENT)}},false);self.bind(TSS_PAUSE_EVENT,function(event){event.stopPropagation();if(canplay){paused=true}var evtAttr=self.getAttribute(TSS_PAUSE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},false);self.bind(TSS_BEGIN_EVENT,function(event){event.stopPropagation();if(delayComputed){if(volume){that.volume=volume}self.setAttribute("tss-state","active")}var evtAttr=self.getAttribute(TSS_BEGIN_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},false);self.bind(TSS_END_EVENT,function(event){event.stopPropagation();paused=true;begun=false;ended=true;var evtAttr=self.getAttribute(TSS_END_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0;self.setAttribute("tss-state","not-active");repeatInstance--;if(repeatInstance<=0){settings.timingPlayState="paused";waiting=false;repeatInstance=repeatCount;if(!settings.timingSyncMaster){window.tempo.remove(self)}initiated=false;delayComputed=true;self.unbind("tempoupdate");self.trigger(TSS_YIELD_EVENT)}else{canplay=true;waiting=false;that.play}},false);var that={};Object.defineProperty(that,"timingDelay",{get:function(){return settings.timingDelay!=null?(parseFloat(settings.timingDelay)):0},set:function(newValue){if(newValue==null){return}settings.timingDelay=newValue!=null?parseFloat(newValue):0;if(!begun){currentTime=settings.timingDelay!=null?(-1*parseFloat(settings.timingDelay)):0}},enumerable:true,configurable:true});Object.defineProperty(that,"timingDuration",{get:function(){if(media_type==0){return Math.min(dur,self.duration-clipBegin)}else{return dur}},set:function(newValue){if(newValue==null){return}dur=newValue=="infinite"?9007199254740992:parseFloat(newValue);settings.timingDuration=dur},enumerable:true,configurable:true});Object.defineProperty(that,"timingIterationCount",{get:function(){return repeatCount==9007199254740992?"infinite":repeatCount},set:function(newValue){if(newValue==null){return}repeatCount=newValue=="infinite"?9007199254740992:parseInt(newValue);repeatInstance=repeatCount;if(repeatCount<=0&&!paused){this.stop}},enumerable:true,configurable:true});Object.defineProperty(that,"timingPlayState",{get:function(){return settings.timingPlayState},set:function(newValue){if(newValue=="paused"){settings.timingPlayState=newValue;this.pause}else{if(newValue=="running"){settings.timingPlayState=newValue;this.play}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingClipBegin",{get:function(){return clipBegin},set:function(newValue){if(newValue==null){return}settings.timingClipBegin=newValue;clipBegin=parseFloat(settings.timingClipBegin);if(media_type==0&&!settings.timingDuration&&clipEnd){dur=typeof clipBegin=="number"&&typeof clipEnd=="number"?clipEnd-clipBegin:9007199254740992;if(!begun){that.currentTime=clipBegin}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingClipEnd",{get:function(){return clipEnd},set:function(newValue){if(newValue==null){return}settings.timingClipEnd=newValue;clipEnd=parseFloat(settings.timingClipEnd);if(media_type==0&&!settings.timingDuration&&clipEnd){dur=typeof clipBegin=="number"&&typeof clipEnd=="number"?clipEnd-clipBegin:9007199254740992}},enumerable:true,configurable:true});Object.defineProperty(that,"timingVolume",{get:function(){return volume},set:function(v){if(newValue==null){return}v=parseFloat(v);if(typeof v=="number"&&!isNaN(v)){volume=v;settings.timingVolume=v;if(media_type==0&&initiated){self.volume=v}}},enumerable:true,configurable:true});Object.defineProperty(that,"timingSyncMaster",{get:function(){return settings.timingSyncMaster},set:function(newValue){if(newValue==null){return}},enumerable:true,configurable:true});Object.defineProperty(that,"initialize",{get:function(){canplay=true;if(initiated){return}self.setAttribute("tss-state","not-active");if(media_type==0){var that=this;self.bind("play",function(event){event.stopPropagation();if(!canplay){self.pause();that.play}if(settings.timingPlayState=="paused"){settings.timingPlayState="running"}if(paused){self.trigger(TSS_PLAY_EVENT)}},true);self.bind("pause",function(event){event.stopPropagation();if(self.ended){return}if(!paused){self.trigger(TSS_PAUSE_EVENT)}},true);self.bind("ended",function(event){event.stopPropagation();if(!ended){self.currentTime=clipBegin;self.trigger(TSS_END_EVENT)}},true);self.bind("timeupdate",function(event){event.stopPropagation();if(paused||!delayComputed){return}try{if(self.currentTime<clipBegin){self.currentTime=clipBegin}}catch(e){}if(self.currentTime>=clipBegin+dur||self.currentTime>=clipEnd){ended=true;paused=true;self.pause();self.currentTime=clipBegin;self.trigger(TSS_END_EVENT)}if(!ended&&delayComputed){currentTime=self.currentTime}self.trigger(TSS_TIMEUPDATE_EVENT,currentTime);var evtAttr=self.getAttribute(TSS_TIMEUPDATE_EVENT);if(evtAttr){try{eval(evtAttr)}catch(e){}}},true);self.bind("seeking",function(event){event.stopPropagation();currentTime=self.currentTime;self.trigger(TSS_TIMEUPDATE_EVENT,self.currentTime)});if(settings.timingSyncMaster){try{findSyncMaster(settings.timingSyncMaster).bind(TSS_TIMEUPDATE_EVENT,timeUpdateListener)}catch(e){}}}if(media_type==1||currentTime<0){var that=this;self.bind("tempoupdate",timeUpdateListener,true);if(settings.timingSyncMaster){try{findSyncMaster(settings.timingSyncMaster).bind(TSS_TIMEUPDATE_EVENT,timeUpdateListener)}catch(e){}}else{window.tempo.add(self)}}initiated=true},enumerable:true,configurable:true});Object.defineProperty(that,"destroy",{get:function(){if(initiated){window.tempo.remove(self);if(self){self.remove()}}self.unbind(TSS_PLAY_EVENT+" "+TSS_PAUSE_EVENT+" "+TSS_BEGIN_EVENT+" "+TSS_END_EVENT+" tempoupdate "+TSS_YIELD_EVENT);delete self},enumerable:true,configurable:true});Object.defineProperty(that,"play",{get:function(){if(begun&&!paused){return}this.initialize;if(media_type==0&&!settings.timingPlayState){settings.timingPlayState="paused"}if(!ended&&settings.timingPlayState=="paused"){return}else{settings.timingPlayState="running"}if(canplay){if(currentTime>=0){if(media_type==0){self.trigger(TSS_PLAY_EVENT);self.play()}else{self.trigger(TSS_PLAY_EVENT)}}else{delayComputed=false;self.trigger(TSS_PLAY_EVENT)}}else{waiting=true;self.trigger(TSS_PAUSE_EVENT);self.trigger(TSS_WAIT_EVENT)}},set:function(force){},enumerable:true,configurable:true});Object.defineProperty(that,"pause",{get:function(){if(!begun||(begun&&paused)){return}waiting=false;if(media_type==0&&delayComputed){self.pause()}else{if(!paused){self.trigger(TSS_PAUSE_EVENT)}}},enumerable:true,configurable:true});Object.defineProperty(that,"stop",{get:function(){if(!begun){return}if(media_type==0){try{self.pause();self.currentTime=clipBegin}catch(e){}}if(!ended){repeatInstance=-1;self.trigger(TSS_END_EVENT)}},enumerable:true,configurable:true});Object.defineProperty(that,"begun",{get:function(){return begun},enumerable:true,configurable:true});Object.defineProperty(that,"ended",{get:function(){return ended},enumerable:true,configurable:true});Object.defineProperty(that,"playing",{get:function(){return !paused},enumerable:true,configurable:true});Object.defineProperty(that,"paused",{get:function(){return paused},enumerable:true,configurable:true});Object.defineProperty(that,"waiting",{get:function(){return waiting},enumerable:true,configurable:true});Object.defineProperty(that,"canplay",{get:function(){return canplay},enumerable:true,configurable:true});Object.defineProperty(that,"volume",{get:function(){return volume},set:function(v){v=parseFloat(v);if(typeof v=="number"&&!isNaN(v)){volume=v;if(media_type==0&&initiated){self.volume=v}}},enumerable:true,configurable:true});Object.defineProperty(that,"currentTime",{get:function(){return currentTime},set:function(t){if(!begun||ended){this.play;this.pause}t=parseFloat(t);if(typeof t=="number"&&!isNaN(t)){currentTime=t;if(media_type==0&&initiated){self.currentTime=t}}},enumerable:true,configurable:true});if(media_type==0){that.initialize}return that};document.addEventListener("ontssparserready",function(e){if(!e.detail){try{window.performance.mark("tss_renderer_time")}catch(e){console.time("calculating tss_renderer_time.js execution time")}var options=extend(window.tss(document.body),{timingContainer:"par",timingPlayState:"running",dur:"infinite",domNode:document.body});extend(document.body.style,new TSSPar(options));try{window.performance.measure("tss_renderer_time");console.log("calculating tss_renderer_time.js execution time: "+(window.performance.getEntriesByType("measure")[1].duration-window.performance.getEntriesByType("mark")[1].startTime).toPrecision(5)+"ms")}catch(e){console.timeEnd("calculating tss_renderer_time.js execution time")}if(document.body.style.timingPlayState!="paused"){document.body.style.play}}else{var elems=document.getElementsByTagName("*");var runningElems=new Array();var pausedElems=new Array();for(var i=0;i<elems.length;i++){if(elems[i].style.begun&&elems[i].style.playing){runningElems.push(elems[i])}if(elems[i].style.paused){pausedElems.push(elems[i])}}for(var i=0;i<elems.length;i++){var elem=elems[i];if(Object.getOwnPropertyDescriptor(elem.style,"timingDelay")){elem.style.stop;parseItem(elem,elem.parentNode)}}if(document.body.style.timingPlayState!="paused"){document.body.style.play}for(var i=runningElems.length-1;i>=0;i--){var style=window.tss(runningElems[i]);if(!style||style.timingPlayState!="paused"){runningElems[i].style.play}}for(var i=pausedElems.length-1;i>=0;i--){pausedElems[i].style.pause}}})})();